<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="小鱼周凌宇のCODE_HOME" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="技术宅 iOS开发 JAVA开发 萌妹子">
<meta property="og:type" content="website">
<meta property="og:title" content="小鱼周凌宇のCODE_HOME">
<meta property="og:url" content="http://zhoulingyu.com/page/11/index.html">
<meta property="og:site_name" content="小鱼周凌宇のCODE_HOME">
<meta property="og:description" content="技术宅 iOS开发 JAVA开发 萌妹子">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小鱼周凌宇のCODE_HOME">
<meta name="twitter:description" content="技术宅 iOS开发 JAVA开发 萌妹子">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://zhoulingyu.com/page/11/"/>

  <title> 小鱼周凌宇のCODE_HOME </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">小鱼周凌宇のCODE_HOME</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">技术宅 iOS开发 JAVA开发 萌妹子</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/about.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/10/27/iOS学习——CocoaPods的使用/" itemprop="url">
                  iOS学习——CocoaPods的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-10-27T09:58:46+08:00" content="2015-10-27">
              2015-10-27
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/10/27/iOS学习——CocoaPods的使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/10/27/iOS学习——CocoaPods的使用/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/10/27/iOS学习——CocoaPods的使用/" class="leancloud_visitors" data-flag-title="iOS学习——CocoaPods的使用">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="CocoaPods"><a href="#CocoaPods" class="headerlink" title="CocoaPods"></a>CocoaPods</h1><p>现在做任何开发都免不了使用第三方库，iOS开发也不例外，每天去逛一逛github成了不可少的必修课。<br>通常，一些简单的框架拖入相应的.h、.m文件就可以使用了。比如<a href="https://github.com/relatedcode/ProgressHUD" target="_blank" rel="external">ProgressHUD</a>、<a href="https://github.com/johnezang/JSONKit" target="_blank" rel="external">JSONKit</a>。但是有时候会出现这样的情况：</p>
<ol>
<li><code>三方库需要依赖系统的一些framework，需要手动的添加</code></li>
<li><code>三方库又使用了三方库，需要再去添加</code></li>
</ol>
<p>这时候，添加库就变成了十分麻烦的事。<br>使用 CocoaPods可以省去这些麻烦，只需要把你想添加的库写在一个文件里，CocoaPods可以帮你一键添加、配置。</p>
<hr>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>CocoaPods安装需要ruby环境，但是 Mac 本身已经安装好了 ruby</p>
<p>需要注意的是，ruby 的软件源 <a href="https://rubygems.org" target="_blank" rel="external">https://rubygems.org</a> 被墙了，所以需要更新 ruby 的源换成源替换成国内淘宝的源 <code>https://ruby.taobao.org/</code> ，在网上看到很多人写成了<a href="http://ruby.taobao.org/，`注意这里一定是https`。" target="_blank" rel="external">http://ruby.taobao.org/，`注意这里一定是https`。</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gem sources --remove https://rubygems.org/</div><div class="line">gem sources -a https://ruby.taobao.org/</div></pre></td></tr></table></figure>
<p>再执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem sources -l</div></pre></td></tr></table></figure>
<p>如果出现了下图，就说明替换成功了<br><img src="http://img.blog.csdn.net/20151027101252947" alt="成功替换"></p>
<p>那么，你只需要在终端：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo gem install cocoapods</div><div class="line">pod setup</div></pre></td></tr></table></figure>
<p>等待一会CocoaPods就安装好了。</p>
<hr>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>新建一个名为 Podfile 的纯文本文件，没有后缀名，放到你项目的根目录。在文件中写入你需要加载的三方库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pod &apos;JSONKit&apos;,       &apos;~&gt; 1.4&apos;</div><div class="line">pod &apos;Masonry&apos;</div><div class="line">pod &apos;FMDB&apos;</div></pre></td></tr></table></figure>
<p>一般在三方库的readme文件中也会告诉你需要写什么，比如：<br><img src="http://img.blog.csdn.net/20151027101816304" alt="第三方库Masonry的reademe文件"></p>
<p>然后在终端输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd &quot;your project home&quot;</div><div class="line">pod install</div></pre></td></tr></table></figure>
<p>等待一会，CocoaPods会把你需要的所有第三方库下载并且设置好编译参数和依赖。这时会发现项目多了一个.xcworkspace文件，<code>记住</code>，以后都要使用.xcworkspace 文件来打开工程。</p>
<h1 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h1><p>如果你又添加新的三方库，可以在Podfile文件中继续添加，然后再终端输入下面的命令CocoaPods就会重新帮你导入。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod update</div></pre></td></tr></table></figure>
<hr>
<h1 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h1><p>之前遇到一个前辈，他们公司刚刚使用CocoaPods（别问我为啥，我也奇了怪了）。然后他们<code>pod update</code>之后，出现了大量的错误。原因是他们之前使用的三方库太老了，早就已经更新，连方法名都变了。为了预防这一类错误，在Podfile中可以指定版本，像这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod &apos;JSONKit&apos;,       &apos;~&gt; 1.4&apos;</div></pre></td></tr></table></figure>
<hr>
<p>有什么问题都可以在博文后面留言，或者微博上私信我，或者邮件我<a href="&#109;&#97;&#105;&#x6c;&#x74;&#x6f;&#x3a;&#99;&#111;&#x64;&#x65;&#x72;&#x66;&#105;&#x73;&#104;&#64;&#x31;&#54;&#51;&#46;&#99;&#x6f;&#109;">&#99;&#111;&#x64;&#x65;&#x72;&#x66;&#105;&#x73;&#104;&#64;&#x31;&#54;&#51;&#46;&#99;&#x6f;&#109;</a>。</p>
<p>博主主要写javaEE和iOS的。</p>
<p>希望大家一起进步。</p>
<p>CSDN： <a href="http://blog.csdn.net/u010127917" target="_blank" rel="external">CSDN博客地址</a></p>
<p>我的微博：<a href="http://weibo.com/coderfish/" target="_blank" rel="external">小鱼周凌宇</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/10/26/iOS学习——FMDB详解/" itemprop="url">
                  iOS学习——FMDB详解
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-10-26T18:54:10+08:00" content="2015-10-26">
              2015-10-26
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/10/26/iOS学习——FMDB详解/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/10/26/iOS学习——FMDB详解/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/10/26/iOS学习——FMDB详解/" class="leancloud_visitors" data-flag-title="iOS学习——FMDB详解">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>FMDB现在越来越多的被使用了，作为轻量级数据库框架，FMDB对sqlite做了简单的包装，使得使用更简单。</p>
<p>但是小鱼认为FMDB还是不好用，毕竟不能做到像hebernate一样传一个对象直接保存，直接省去sql语句。之后小鱼打算自己动封装一个框架，至少能够对简单的entity进行一键增删改查。</p>
<hr>
<h1 id="GitHub"><a href="#GitHub" class="headerlink" title="GitHub"></a>GitHub</h1><p>FMDB链接：<a href="https://github.com/ccgus/fmdb" target="_blank" rel="external">https://github.com/ccgus/fmdb</a></p>
<hr>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="1-使用CocoaPods安装"><a href="#1-使用CocoaPods安装" class="headerlink" title="1. 使用CocoaPods安装"></a>1. 使用CocoaPods安装</h2><p>pods安装当然是最简单的，在Podfile文件中加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod &apos;FMDB&apos;</div></pre></td></tr></table></figure>
<p>然后终端进入项目根目录，输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod install</div></pre></td></tr></table></figure>
<p>等待安装完就好了</p>
<p>如果不会使用CocoaPods，可以参考我的这篇博文：<a href="http://zhoulingyu.com/2015/10/27/iOS学习——CocoaPods的使用/">iOS学习——CocoaPods的使用</a></p>
<h2 id="2-传统拖文件安装"><a href="#2-传统拖文件安装" class="headerlink" title="2. 传统拖文件安装"></a>2. 传统拖文件安装</h2><p>在github上下载FMDB，把这些文件直接拖入你的项目就可以用了</p>
<p><img src="http://img.blog.csdn.net/20151027094718635" alt="FMDB所需要的文件"></p>
<hr>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>首先要在用到的地方</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"FMDB.h"</span></span></div></pre></td></tr></table></figure>
<h2 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h2><p>如果该位置没有此数据库文件将会建立一个新的数据库文件，如果已经有了，将会直接获得该数据库。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FMDatabase *db = [FMDatabase databaseWithPath:dataBasePath];</div></pre></td></tr></table></figure>
<p>dataBasePath可以这样设定：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#define dataBasePath [[(NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask,YES)) lastObject]stringByAppendingPathComponent:dataBaseName]</span></div><div class="line"><span class="meta">#define dataBaseName @<span class="meta-string">"test.sqlite"</span></span></div></pre></td></tr></table></figure>
<h2 id="打开数据库"><a href="#打开数据库" class="headerlink" title="打开数据库"></a>打开数据库</h2><p>返回BOOL类型，代表是否成功</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[db open]</div></pre></td></tr></table></figure>
<h2 id="关闭数据库"><a href="#关闭数据库" class="headerlink" title="关闭数据库"></a>关闭数据库</h2><p>返回BOOL类型，代表是否成功</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[db close]</div></pre></td></tr></table></figure>
<h2 id="建表"><a href="#建表" class="headerlink" title="建表"></a>建表</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.db open]) &#123;</div><div class="line">	<span class="built_in">NSString</span> *sqlCreateTable = <span class="string">@"CREATE TABLE IF NOT EXISTS Question (UUID TEXT PRIMARY KEY, type TEXT, bigQuetionIndex INTEGER, smallQuetionIndex INTEGER, state TEXT, time INTEGER, elapsedTime INTEGER, studentAnswer TEXT, answer TEXT, studentGrade INTEGER, grade INTEGER, content TEXT, examPaperUUID TEXT)"</span>;</div><div class="line">	      </div><div class="line">	<span class="built_in">BOOL</span> res = [<span class="keyword">self</span>.db executeStatements:sqlCreateTable];</div><div class="line">	<span class="keyword">if</span> (!res) &#123;</div><div class="line">		<span class="built_in">CFLog</span>(<span class="string">@"error when creating db table"</span>);</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		<span class="built_in">CFLog</span>(<span class="string">@"success to creating db table"</span>);</div><div class="line">	&#125;</div><div class="line">	[<span class="keyword">self</span>.db close];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="增加数据"><a href="#增加数据" class="headerlink" title="增加数据"></a>增加数据</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.db open]) &#123;</div><div class="line">	 <span class="built_in">NSString</span> *sql = <span class="string">@"INSERT INTO t_entity (UUID, title) VALUES (?, ?)"</span>;</div><div class="line">        </div><div class="line">        <span class="built_in">BOOL</span> res = [<span class="keyword">self</span>.db executeUpdate:sql, entity.UUID, entity.title];</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> (!res) &#123;</div><div class="line">            <span class="built_in">CFLog</span>(<span class="string">@"error when insert db table"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="built_in">CFLog</span>(<span class="string">@"success to insert db table"</span>);</div><div class="line">	&#125;</div><div class="line">	[<span class="keyword">self</span>.db close];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.db open]) &#123;</div><div class="line">        <span class="built_in">NSString</span> *sql = <span class="string">@"DELETE FROM t_entity WHERE UUID = ?"</span>;</div><div class="line">        <span class="built_in">BOOL</span> res = [<span class="keyword">self</span>.db executeUpdate:sql, UUID];</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> (!res) &#123;</div><div class="line">            <span class="built_in">CFLog</span>(<span class="string">@"error when DELETE db table"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="built_in">CFLog</span>(<span class="string">@"success to DELETE db table"</span>);</div><div class="line">        &#125;</div><div class="line">        [<span class="keyword">self</span>.db close];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.db open]) &#123;</div><div class="line">        <span class="built_in">NSString</span> *sql = <span class="string">@"UPDATE t_entity SET title = ?"</span>;</div><div class="line">        <span class="built_in">BOOL</span> res = [<span class="keyword">self</span>.db executeUpdate:sql,</div><div class="line">                    examPaper.title,</div><div class="line">                    examPaper.UUID];</div><div class="line">        <span class="keyword">if</span> (!res) &#123;</div><div class="line">            <span class="built_in">CFLog</span>(<span class="string">@"error when UPDATE db table"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="built_in">CFLog</span>(<span class="string">@"success to UPDATE db table"</span>);</div><div class="line">        &#125;</div><div class="line">        [<span class="keyword">self</span>.db close];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="查找数据"><a href="#查找数据" class="headerlink" title="查找数据"></a>查找数据</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Entity *entity;</div><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.db open]) &#123;</div><div class="line">	<span class="comment">//返回数据库中第一条满足条件的结果</span></div><div class="line">	<span class="built_in">NSString</span> *sql = <span class="string">@"SELECT * FROM t_entity WHERE UUID = ?"</span>;</div><div class="line">        </div><div class="line">	<span class="comment">//返回全部查询结果</span></div><div class="line">	FMResultSet *rs=[<span class="keyword">self</span>.db executeQuery:sql, UUID, <span class="literal">nil</span>];</div><div class="line">        </div><div class="line">	<span class="keyword">while</span> ([rs next])&#123;</div><div class="line">		entity = [[Entity alloc] init];</div><div class="line">		entity.UUID = [rs stringForColumn:<span class="string">@"UUID"</span>];</div><div class="line">		entity.type = [rs stringForColumn:<span class="string">@"type"</span>];</div><div class="line">	&#125;</div><div class="line">        </div><div class="line">	[rs close];</div><div class="line">	[<span class="keyword">self</span>.db close];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="重要提示：使用占位符『-』"><a href="#重要提示：使用占位符『-』" class="headerlink" title="重要提示：使用占位符『?』"></a>重要提示：使用占位符『?』</h2><p>我在网上看到很多人是这样用的</p>
<p><code>错误代码：</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *sql = [<span class="built_in">NSString</span> stringWithFormat: <span class="string">@"INSERT INTO '%@' ('%@', '%@', '%@') VALUES ('%@', '%@', '%@')"</span>, TABLENAME, NAME, AGE, ADDRESS, <span class="string">@"value1"</span>, <span class="string">@"value2"</span>, <span class="string">@"value3"</span>];  </div><div class="line"><span class="built_in">BOOL</span> res = [db sql];</div></pre></td></tr></table></figure>
<p>这是 <code>错误</code> 的，在官方文档上已经指出：</p>
<blockquote>
<p>you SHOULD NOT do this (or anything like this):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; [db executeUpdate:[NSString stringWithFormat:@&quot;INSERT INTO myTable VALUES (%@)&quot;, @&quot;this has \&quot; lots of &apos; bizarre \&quot; quotes &apos;&quot;]];</div><div class="line">&gt;</div></pre></td></tr></table></figure>
<p>Instead, you SHOULD do:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; [db executeUpdate:@&quot;INSERT INTO myTable VALUES (?)&quot;, @&quot;this has \&quot; lots of &apos; bizarre \&quot; quotes &apos;&quot;];</div><div class="line">&gt;</div></pre></td></tr></table></figure>
</blockquote>
<p>也就是说不应该使用拼串的方式，而应该使用<code>占位符</code></p>
<h2 id="重要提示：使用NSNumber保存"><a href="#重要提示：使用NSNumber保存" class="headerlink" title="重要提示：使用NSNumber保存"></a>重要提示：使用NSNumber保存</h2><p>官方文档指出，用int保存是 <code>不起作用</code> 的：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[db executeUpdate:<span class="string">@"INSERT INTO myTable VALUES (?)"</span>, <span class="number">42</span>];</div></pre></td></tr></table></figure>
<p><code>正确</code> 的做法是这样的：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[db executeUpdate:<span class="string">@"INSERT INTO myTable VALUES (?)"</span>, &gt; [<span class="built_in">NSNumber</span> numberWithInt:<span class="number">42</span>]];</div></pre></td></tr></table></figure>
<hr>
<p>有什么问题都可以在博文后面留言，或者微博上私信我，或者邮件我<a href="&#x6d;&#x61;&#105;&#x6c;&#x74;&#x6f;&#58;&#x63;&#x6f;&#x64;&#101;&#114;&#x66;&#x69;&#115;&#104;&#x40;&#x31;&#x36;&#51;&#x2e;&#99;&#111;&#109;">&#x63;&#x6f;&#x64;&#101;&#114;&#x66;&#x69;&#115;&#104;&#x40;&#x31;&#x36;&#51;&#x2e;&#99;&#111;&#109;</a>。</p>
<p>博主主要写javaEE和iOS的。</p>
<p>希望大家一起进步。</p>
<p>CSDN： <a href="http://blog.csdn.net/u010127917" target="_blank" rel="external">CSDN博客地址</a></p>
<p>我的微博：<a href="http://weibo.com/coderfish/" target="_blank" rel="external">小鱼周凌宇</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/10/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/12/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="小鱼周凌宇" />
          <p class="site-author-name" itemprop="name">小鱼周凌宇</p>
          <p class="site-description motion-element" itemprop="description">技术宅 iOS开发 JAVA开发 萌妹子</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">42</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/summertian4" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/coderfish" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/coderfish" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">小鱼周凌宇</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

<span id="busuanzi_container_site_pv">
    | 本站总访问量<span id="busuanzi_value_site_pv"></span>次 (统计起始日期:2016年8月4日)
</span>
        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"14076594"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("PI8DkEcwwAeUsSvTJirjB4NY-gzGzoHsz", "F82ePXFzAey9dKSBAFdoB6ka");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
